import streamlit as st
from datb_anime import datab
from datetime import date


datab.criar_tabela()

def salvar_anime(titulo, ano, nota):
    datab.inserir_anime(titulo,ano,nota)
    st.success(f'Anime "{titulo}" salvo com sucesso!', icon="✅")

def carregar_animes():
    try:
        dados = datab.listar_animes()
        if not dados:
            st.info('Nenhum anime encontrado no Banco de Dados',  icon="ℹ️")
            return []
        
        animes_dados = [
            {
                "id": anim[0],
                "titulo": anim[1],
                "ano": anim[2],
                "nota": anim[3]
            }
                for anim in dados
        ]
        return animes_dados
    except Exception as e:
        st.error(f'Erro ao carregar os Animes: {e}')
        return []
    

st.set_page_config(page_title="Avaliador de Animes", layout="wide")
st.title("Avaliador de Animes")
st.subheader("Bem-vindo ao Avaliador de Animes!")

aba1, aba2, aba3 = st.tabs(['Novo Anime', 'Avaliar Anime', 'Vizualizar Avaliações'])

with aba1:
    st.header('Adicionar novo Anime')

    titulo = st.text_input('Título', placeholder='Digite o nome no Anime')
    ano = st.date_input('Ano de lançamento', max_value=date.today(), min_value=date(1900, 1, 1))
    nota = st